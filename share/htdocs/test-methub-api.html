<!DOCTYPE html>
<html>
<head>
    <title>MetHub API Test</title>
</head>
<body>
    <h1>MetHub API Test</h1>
    <div id="results"></div>
    
    <script src="methub/methub-api.js"></script>
    <script>
        async function testAPI() {
            const api = new MetHubAPI();
            
            // Login first
            try {
                console.log('Logging in...');
                await api.login('admin', 'admin');
                console.log('Login successful');
                
                // Query metrics
                console.log('Querying CPU metrics...');
                const cpuMetrics = await api.queryMetrics('1h', null, 'cpu', 'cpu_usage');
                console.log('CPU metrics:', cpuMetrics);
                
                console.log('Querying all metrics...');
                const allMetrics = await api.queryMetrics('1h');
                console.log('All metrics:', allMetrics);
                
                console.log('Getting hosts...');
                const hosts = await api.getHosts();
                console.log('Hosts:', hosts);
                
                document.getElementById('results').innerHTML = `
                    <h2>Results:</h2>
                    <p>CPU Metrics: ${cpuMetrics.length}</p>
                    <p>All Metrics: ${allMetrics.length}</p>
                    <p>Hosts: ${hosts.join(', ')}</p>
                    <pre>${JSON.stringify({cpuMetrics: cpuMetrics.slice(0,3), allMetrics: allMetrics.slice(0,3)}, null, 2)}</pre>
                `;
                
            } catch (error) {
                console.error('Test failed:', error);
                document.getElementById('results').innerHTML = `<p>Error: ${error.message}</p>`;
            }
        }
        
        testAPI();
    </script>
</body>
</html>