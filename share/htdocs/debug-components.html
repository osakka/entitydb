<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EntityDB Component Debug</title>
    
    <!-- Vue 3 Production Build -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    
    <!-- Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    
    <!-- ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.44.0/dist/apexcharts.min.js"></script>
    
    <!-- Load components in order -->
    <script src="/js/simple-grid-layout.js"></script>
    <script src="/js/entitydb-widgets.js"></script>
    <script src="/js/entity-browser.js"></script>
    <script src="/js/rbac-manager.js"></script>
    <script src="/js/dataset-manager.js"></script>
    
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f6fa;
            padding: 20px;
        }
        .debug-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .component-check {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 4px;
        }
        .component-check.success {
            background: #d4edda;
            color: #155724;
        }
        .component-check.error {
            background: #f8d7da;
            color: #721c24;
        }
        .test-area {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 4px;
        }
        pre {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <div id="app" class="debug-container">
        <h1>EntityDB Component Debug</h1>
        
        <h2>Component Loading Status</h2>
        <div class="component-check" :class="components.Vue ? 'success' : 'error'">
            <span>Vue 3</span>
            <span>{{ components.Vue ? '✅ Loaded' : '❌ Not Found' }}</span>
        </div>
        <div class="component-check" :class="components.SimpleGridLayout ? 'success' : 'error'">
            <span>SimpleGridLayout</span>
            <span>{{ components.SimpleGridLayout ? '✅ Loaded' : '❌ Not Found' }}</span>
        </div>
        <div class="component-check" :class="components.SimpleGridItem ? 'success' : 'error'">
            <span>SimpleGridItem</span>
            <span>{{ components.SimpleGridItem ? '✅ Loaded' : '❌ Not Found' }}</span>
        </div>
        <div class="component-check" :class="components.EntityDBWidgets ? 'success' : 'error'">
            <span>EntityDBWidgets</span>
            <span>{{ components.EntityDBWidgets ? '✅ Loaded' : '❌ Not Found' }}</span>
        </div>
        <div class="component-check" :class="components.EntityBrowser ? 'success' : 'error'">
            <span>EntityBrowser</span>
            <span>{{ components.EntityBrowser ? '✅ Loaded' : '❌ Not Found' }}</span>
        </div>
        <div class="component-check" :class="components.RBACManager ? 'success' : 'error'">
            <span>RBACManager</span>
            <span>{{ components.RBACManager ? '✅ Loaded' : '❌ Not Found' }}</span>
        </div>
        <div class="component-check" :class="components.DatasetManager ? 'success' : 'error'">
            <span>DatasetManager</span>
            <span>{{ components.DatasetManager ? '✅ Loaded' : '❌ Not Found' }}</span>
        </div>
        <div class="component-check" :class="components.ApexCharts ? 'success' : 'error'">
            <span>ApexCharts</span>
            <span>{{ components.ApexCharts ? '✅ Loaded' : '❌ Not Found' }}</span>
        </div>
        
        <h2>Console Errors</h2>
        <div class="test-area">
            <p>Check browser console (F12) for any JavaScript errors.</p>
            <button @click="testComponents" class="btn">Test All Components</button>
        </div>
        
        <h2>Component Details</h2>
        <pre>{{ componentDetails }}</pre>
        
        <h2>Test Results</h2>
        <div v-if="testResults" class="test-area">
            <pre>{{ testResults }}</pre>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        
        createApp({
            data() {
                return {
                    components: {
                        Vue: false,
                        SimpleGridLayout: false,
                        SimpleGridItem: false,
                        EntityDBWidgets: false,
                        EntityBrowser: false,
                        RBACManager: false,
                        DatasetManager: false,
                        ApexCharts: false
                    },
                    componentDetails: '',
                    testResults: null
                };
            },
            mounted() {
                this.checkComponents();
                this.getComponentDetails();
            },
            methods: {
                checkComponents() {
                    this.components.Vue = !!window.Vue;
                    this.components.SimpleGridLayout = !!window.SimpleGridLayout;
                    this.components.SimpleGridItem = !!window.SimpleGridItem;
                    this.components.EntityDBWidgets = !!window.EntityDBWidgets;
                    this.components.EntityBrowser = !!window.EntityBrowser;
                    this.components.RBACManager = !!window.RBACManager;
                    this.components.DatasetManager = !!window.DatasetManager;
                    this.components.ApexCharts = !!window.ApexCharts;
                },
                
                getComponentDetails() {
                    const details = {
                        SimpleGridLayout: window.SimpleGridLayout ? {
                            name: window.SimpleGridLayout.name,
                            props: Object.keys(window.SimpleGridLayout.props || {})
                        } : null,
                        EntityBrowser: window.EntityBrowser ? {
                            name: window.EntityBrowser.name,
                            hasTemplate: !!window.EntityBrowser.template
                        } : null,
                        RBACManager: window.RBACManager ? {
                            name: window.RBACManager.name,
                            hasTemplate: !!window.RBACManager.template
                        } : null,
                        DatasetManager: window.DatasetManager ? {
                            name: window.DatasetManager.name,
                            hasTemplate: !!window.DatasetManager.template
                        } : null,
                        EntityDBWidgets: window.EntityDBWidgets ? {
                            available: Object.keys(window.EntityDBWidgets)
                        } : null
                    };
                    
                    this.componentDetails = JSON.stringify(details, null, 2);
                },
                
                testComponents() {
                    const results = [];
                    
                    // Test Vue
                    try {
                        const testApp = Vue.createApp({});
                        results.push('✅ Vue 3 is working');
                    } catch (e) {
                        results.push('❌ Vue 3 error: ' + e.message);
                    }
                    
                    // Test grid layout
                    try {
                        if (window.SimpleGridLayout) {
                            results.push('✅ SimpleGridLayout is accessible');
                        } else {
                            results.push('❌ SimpleGridLayout not found');
                        }
                    } catch (e) {
                        results.push('❌ Grid layout error: ' + e.message);
                    }
                    
                    // Test other components
                    ['EntityBrowser', 'RBACManager', 'DatasetManager'].forEach(comp => {
                        try {
                            if (window[comp] && window[comp].template) {
                                results.push(`✅ ${comp} has template`);
                            } else {
                                results.push(`❌ ${comp} missing or incomplete`);
                            }
                        } catch (e) {
                            results.push(`❌ ${comp} error: ${e.message}`);
                        }
                    });
                    
                    this.testResults = results.join('\n');
                }
            }
        }).mount('#app');
    </script>
</body>
</html>